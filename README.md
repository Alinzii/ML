# ML
ML Class Fall2026 Dr.Eslami

**معرفی**  
این پروژه قدرت یادگیری ماشین و بینایی کامپیوتر را با هم ترکیب کرده تا بتواند پرتاب‌های بسکتبال را در زمان واقعی تشخیص و تحلیل کند. این برنامه که بر پایه آخرین مدل یادگیری ماشین YOLOv8  و کتابخانه OpenCV ساخته شده است.
**آموزش مدل**  
فرآیند آموزش از پیاده‌سازی ultralytics YOLO و یک مجموعه دیتاست که در فایل `config.yaml` مشخص شده استفاده می‌کند. مدل در تعداد مشخصی دوره (epoch) آموزش می‌بیند و وزن‌های بهترین مدل برای استفاده بعدی در تشخیص پرتاب ذخیره می‌شود. 
**الگوریتم**  
هسته این پروژه یک الگوریتم است که از مدل آموزش‌دیده YOLOv8 برای تشخیص توپ و حلقه بسکتبال در هر فریم استفاده می‌کند. سپس حرکت و موقعیت توپ نسبت به حلقه را تحلیل می‌کند تا مشخص کند آیا پرتاب موفقیت‌آمیز بوده است یا خیر.
برای بهبود دقت تشخیص پرتاب، الگوریتم نه‌تنها موقعیت توپ را در طول زمان ردیابی می‌کند، بلکه تکنیک‌های پاکسازی داده را نیز روی موقعیت‌های توپ و حلقه اعمال می‌کند. این الگوریتم طوری طراحی شده که نقاط داده نادرست را فیلتر کند، نقاط فراتر از حد مشخصی از فریم‌ها را حذف نماید و از پرش ردیابی بین اشیاء مختلف جلوگیری کند تا دقت تشخیص حفظ شود.
یک رگرسیون خطی برای پیش‌بینی مسیر حرکت توپ بر اساس موقعیت‌های آن استفاده می‌شود. اگر مسیر پیش‌بینی‌شده با حلقه تقاطع داشته باشد، الگوریتم آن را به عنوان یک پرتاب موفق ثبت می‌کند.
**نحوه استفاده از کد**  
1. این مخزن را روی ماشین محلی خود کلون کنید. نیازمندی‌ها را نصب نمایید.
2. مجموعه داده مشخص‌شده در `config.yaml` را دانلود کرده و مسیرهای فایل را با تنظیمات خود تطبیق دهید.
3. دستورالعمل‌های موجود در `main.py` را برای آموزش مدل و آماده‌سازی تشخیص پرتاب دنبال کنید.
4. `shot_detector.py` را از طریق وب‌کم برای تشخیص زنده پرتاب اجرا کنید. یا یک ویدیو برای تحلیل تشخیص پرتاب وارد نمایید.
5. اگر نمی‌خواهید خودتان مدل را آموزش دهید، لطفاً از مدل از پیش آموزش‌دیده `best.pt` استفاده کنید.

